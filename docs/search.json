[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Paul Roback",
    "section": "",
    "text": "Professor of Statistics and Data Science  MSCS Department @ St. Olaf College\n\n\nPhD in Statistics 1998 | Colorado State University\nMS in Statistics 1991 | Iowa State University\nBA in Math and Economics with Statistics concentration 1989 | St. Olaf College"
  },
  {
    "objectID": "index.html#paul-roback",
    "href": "index.html#paul-roback",
    "title": "Paul Roback",
    "section": "",
    "text": "Professor of Statistics and Data Science  MSCS Department @ St. Olaf College\n\n\nPhD in Statistics 1998 | Colorado State University\nMS in Statistics 1991 | Iowa State University\nBA in Math and Economics with Statistics concentration 1989 | St. Olaf College"
  },
  {
    "objectID": "02_maps_part1.html",
    "href": "02_maps_part1.html",
    "title": "Creating informative maps",
    "section": "",
    "text": "Based on Section 3.2.3 from Modern Data Science with R.\nYou can download this .qmd file from here. Just hit the Download Raw File button.\n\n# Initial packages required (we'll be adding more)\nlibrary(tidyverse)\nlibrary(mdsr)      # package associated with our MDSR book\n\n\nChoropleth Maps\nWhen you have specific regions (e.g. countries, states, counties, census tracts,…) and a value associated with each region.\nA choropleth map will color the entire region according to the value. For example, let’s consider state vaccination data from March 2021.\n\nvaccines &lt;- read_csv(\"https://proback.github.io/264_fall_2024/Data/vacc_Mar21.csv\") \n\nvacc_mar13 &lt;- vaccines |&gt;\n  filter(Date ==\"2021-03-13\") |&gt;\n  select(State, Date, people_vaccinated_per100, share_doses_used, Governor)\n\nvacc_mar13\n\n# A tibble: 50 × 5\n   State       Date       people_vaccinated_per100 share_doses_used Governor\n   &lt;chr&gt;       &lt;date&gt;                        &lt;dbl&gt;            &lt;dbl&gt; &lt;chr&gt;   \n 1 Alabama     2021-03-13                     17.2            0.671 R       \n 2 Alaska      2021-03-13                     27.0            0.686 R       \n 3 Arizona     2021-03-13                     21.5            0.821 R       \n 4 Arkansas    2021-03-13                     19.2            0.705 R       \n 5 California  2021-03-13                     20.3            0.726 D       \n 6 Colorado    2021-03-13                     20.8            0.801 D       \n 7 Connecticut 2021-03-13                     26.2            0.851 D       \n 8 Delaware    2021-03-13                     20.2            0.753 D       \n 9 Florida     2021-03-13                     20.1            0.766 R       \n10 Georgia     2021-03-13                     15.2            0.674 R       \n# ℹ 40 more rows\n\n\nThe tricky part of choropleth maps is getting the shapes (polygons) that make up the regions. This is really a pretty complex set of lines for R to draw!\nLuckily, some maps are already created in R in the maps package.\n\nlibrary(maps)\nus_states &lt;- map_data(\"state\")\nhead(us_states)\n\n       long      lat group order  region subregion\n1 -87.46201 30.38968     1     1 alabama      &lt;NA&gt;\n2 -87.48493 30.37249     1     2 alabama      &lt;NA&gt;\n3 -87.52503 30.37249     1     3 alabama      &lt;NA&gt;\n4 -87.53076 30.33239     1     4 alabama      &lt;NA&gt;\n5 -87.57087 30.32665     1     5 alabama      &lt;NA&gt;\n6 -87.58806 30.32665     1     6 alabama      &lt;NA&gt;\n\n# Note that points in the same \"group\" are connected with a line\n\nus_states |&gt;\n  ggplot(mapping = aes(x = long, y = lat,\n                          group = group)) + \n  geom_polygon(fill = \"white\", color = \"black\")\n\n\n\n\n\nvacc_mar13 &lt;- vacc_mar13 |&gt;\n  mutate(State = str_to_lower(State))\n\nvacc_mar13 |&gt;\n  right_join(us_states, by = c(\"State\" = \"region\")) |&gt;\n  rename(region = State) |&gt;\n  ggplot(mapping = aes(x = long, y = lat,\n                          group = group)) + \n  geom_polygon(aes(fill = people_vaccinated_per100), color = \"black\")\n\n\n\n\noops, New York appears to be a problem.\n\nvacc_mar13 &lt;- vacc_mar13 |&gt;\n  mutate(State = str_replace(State, \" state\", \"\"))\n\nvacc_mar13 |&gt;\n  anti_join(us_states, by = c(\"State\" = \"region\"))\n\n# A tibble: 2 × 5\n  State  Date       people_vaccinated_per100 share_doses_used Governor\n  &lt;chr&gt;  &lt;date&gt;                        &lt;dbl&gt;            &lt;dbl&gt; &lt;chr&gt;   \n1 alaska 2021-03-13                     27.0            0.686 R       \n2 hawaii 2021-03-13                     22.8            0.759 D       \n\nus_states |&gt;\n  anti_join(vacc_mar13, by = c(\"region\" = \"State\")) %&gt;%\n  count(region)\n\n                region  n\n1 district of columbia 10\n\n\nBetter.\n\nlibrary(viridis) # for color schemes\nvacc_mar13 |&gt;\n  right_join(us_states, by = c(\"State\" = \"region\")) |&gt;\n  rename(region = State) |&gt;\n  ggplot(mapping = aes(x = long, y = lat,\n                          group = group)) + \n  geom_polygon(aes(fill = people_vaccinated_per100), color = \"black\") + \n  labs(fill = \"People Vaccinated\\nper 100 pop.\") +\n  # This scales the longitude and latitude so that the shapes look correct.\n  coord_map() + \n  # This theme can give you a really clean look!\n  theme_void() +  \n  # you can change the fill scale for different color schemes.\n  scale_fill_viridis() \n\n\n\n\nYou can also use a categorical variable to color regions:\n\nvacc_mar13 |&gt;\n  right_join(us_states, by = c(\"State\" = \"region\")) |&gt;\n  rename(region = State) |&gt;\n  ggplot(mapping = aes(x = long, y = lat,\n                          group = group)) + \n  geom_polygon(aes(fill = Governor), color = \"darkgrey\", linewidth = 0.2) + \n  labs(fill = \"Governor\") +\n  # This scales the longitude and latitude so that the shapes look correct.\n  coord_map() + \n  # This theme can give you a really clean look!\n  theme_void() +  \n  # you can change the fill scale for different color schemes.\n  scale_fill_manual(values = c(\"blue\", \"red\"))"
  },
  {
    "objectID": "03_maps_part2.html",
    "href": "03_maps_part2.html",
    "title": "Working with geospatial data",
    "section": "",
    "text": "Based on Chapter 17 from Modern Data Science with R.\nYou can download this .qmd file from here. Just hit the Download Raw File button.\n\n# Initial packages required (we'll be adding more)\nlibrary(tidyverse)\nlibrary(mdsr)      # package associated with our MDSR book\nlibrary(sf)        \n# sf = support for simple features, a standardized way to encode spatial vector data\nlibrary(ggspatial)\n\nOur goal in “Maps - Part 2” is to learn about how to work with shapefiles, which are an open data structure for encoding spatial information. We will learn about projections (from three-dimensional space into two-dimensional space) and how to create informative, spatially-aware visualizations. We will just skim the surface in 264; for a much more thorough coverage, take our Spatial Statistics course!\n\nSection 17.4: Extended example: NC Congressional Districts\nIn North Carolina, there are about the same number of Democratic and Republican voters in the state. In the fall of 2020, 10 of North Carolina’s 13 congressional representatives were Republican (with one seat currently vacant). How can this be? In this case, geospatial data can help us understand.\nNote: the seats are currently 7 and 7 (NC earned an additional seat for 2022 after the 2020 Census), but 3 are expected to flip back to Republicans again after yet another round of questionable redistricting\n\n# To install fec 12 the first time, uncomment the code below (you might have to install devtools as well):\n# devtools::install_github(\"baumer-lab/fec12\")\nlibrary(fec12)\nprint(results_house, width = Inf)\n\n# A tibble: 2,343 × 13\n   state district_id cand_id   incumbent party primary_votes primary_percent\n   &lt;chr&gt; &lt;chr&gt;       &lt;chr&gt;     &lt;lgl&gt;     &lt;chr&gt;         &lt;dbl&gt;           &lt;dbl&gt;\n 1 AL    01          H2AL01077 TRUE      R             48702          0.555 \n 2 AL    01          H2AL01176 FALSE     R             21308          0.243 \n 3 AL    01          H2AL01184 FALSE     R             13809          0.158 \n 4 AL    01          H0AL01030 FALSE     R              3854          0.0440\n 5 AL    02          H0AL02087 TRUE      R                NA         NA     \n 6 AL    02          H2AL02141 FALSE     D                NA         NA     \n 7 AL    03          H2AL03032 TRUE      R                NA         NA     \n 8 AL    03          H2AL03099 FALSE     D                NA         NA     \n 9 AL    04          H6AL04098 TRUE      R                NA         NA     \n10 AL    04          H2AL04055 FALSE     D             10971          0.514 \n   runoff_votes runoff_percent general_votes general_percent won   footnotes\n          &lt;dbl&gt;          &lt;dbl&gt;         &lt;dbl&gt;           &lt;dbl&gt; &lt;lgl&gt; &lt;chr&gt;    \n 1           NA             NA        196374           0.979 TRUE  &lt;NA&gt;     \n 2           NA             NA            NA          NA     FALSE &lt;NA&gt;     \n 3           NA             NA            NA          NA     FALSE &lt;NA&gt;     \n 4           NA             NA            NA          NA     FALSE &lt;NA&gt;     \n 5           NA             NA        180591           0.636 TRUE  &lt;NA&gt;     \n 6           NA             NA        103092           0.363 FALSE &lt;NA&gt;     \n 7           NA             NA        175306           0.640 TRUE  &lt;NA&gt;     \n 8           NA             NA         98141           0.358 FALSE &lt;NA&gt;     \n 9           NA             NA        199071           0.740 TRUE  &lt;NA&gt;     \n10           NA             NA         69706           0.259 FALSE &lt;NA&gt;     \n# ℹ 2,333 more rows\n\nresults_house |&gt;\n  group_by(state, district_id) |&gt;\n  summarize(N = n())\n\n# A tibble: 445 × 3\n# Groups:   state [56]\n   state district_id     N\n   &lt;chr&gt; &lt;chr&gt;       &lt;int&gt;\n 1 AK    00             10\n 2 AL    01              4\n 3 AL    02              2\n 4 AL    03              2\n 5 AL    04              3\n 6 AL    05              3\n 7 AL    06              6\n 8 AL    07              3\n 9 AR    01              6\n10 AR    02              4\n# ℹ 435 more rows\n\n\n[Pause to ponder:] Why are there 435 Representatives in the US House but 445 state/district combinations in our data? And how should we handle cases in which there’s just not 1 Democrat vs 1 Republican?\n\n# summary of the 13 congressional NC districts and the 2012 voting\ndistrict_elections &lt;- results_house |&gt;\n  mutate(district = parse_number(district_id)) |&gt;\n  group_by(state, district) |&gt;\n  summarize(\n    N = n(), \n    total_votes = sum(general_votes, na.rm = TRUE),\n    d_votes = sum(ifelse(party == \"D\", general_votes, 0), na.rm = TRUE),\n    r_votes = sum(ifelse(party == \"R\", general_votes, 0), na.rm = TRUE),\n    .groups = \"drop\"\n  ) |&gt;\n  mutate(\n    other_votes = total_votes - d_votes - r_votes,\n    r_prop = r_votes / total_votes,  \n    winner = ifelse(r_votes &gt; d_votes, \"Republican\", \"Democrat\")\n  )\nnc_results &lt;- district_elections |&gt;\n  filter(state == \"NC\")\nnc_results |&gt;                  \n  select(-state)\n\n# A tibble: 13 × 8\n   district     N total_votes d_votes r_votes other_votes r_prop winner    \n      &lt;dbl&gt; &lt;int&gt;       &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;       &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;     \n 1        1     4      338066  254644   77288        6134  0.229 Democrat  \n 2        2     8      311397  128973  174066        8358  0.559 Republican\n 3        3     3      309885  114314  195571           0  0.631 Republican\n 4        4     4      348485  259534   88951           0  0.255 Democrat  \n 5        5     3      349197  148252  200945           0  0.575 Republican\n 6        6     4      364583  142467  222116           0  0.609 Republican\n 7        7     4      336736  168695  168041           0  0.499 Democrat  \n 8        8     8      301824  137139  160695        3990  0.532 Republican\n 9        9    13      375690  171503  194537        9650  0.518 Republican\n10       10     6      334849  144023  190826           0  0.570 Republican\n11       11    11      331426  141107  190319           0  0.574 Republican\n12       12     3      310908  247591   63317           0  0.204 Democrat  \n13       13     5      370610  160115  210495           0  0.568 Republican\n\n\n[Pause to ponder:]\n\nExplain how sum(ifelse(party == \"D\", general_votes, 0), na.rm = TRUE) works\nExplain why we use .groups = \"drop\". Hint: try excluding that line and running again.\nDo you see any potential problems with ifelse(r_votes &gt; d_votes, \"Republican\", \"Democrat\")?\nWhat observations can you make about the final nc_results table?\n\n\n# distribution of total number of votes is narrow by design\nnc_results |&gt;\n  skim(total_votes) |&gt;\n  select(-na)\n\nVariable type: numeric\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar\nn\nmean\nsd\np0\np25\np50\np75\np100\n\n\n\n\ntotal_votes\n13\n337204.3\n24175.2\n301824\n311397\n336736\n349197\n375690\n\n\n\n\n# compare total Dem and Rep votes across NC in 2012\nnc_results |&gt;\n  summarize(\n    N = n(), \n    state_votes = sum(total_votes), \n    state_d = sum(d_votes), \n    state_r = sum(r_votes)\n  ) |&gt;\n  mutate(\n    d_prop = state_d / state_votes, \n    r_prop = state_r / state_votes\n  )\n\n# A tibble: 1 × 6\n      N state_votes state_d state_r d_prop r_prop\n  &lt;int&gt;       &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;\n1    13     4383656 2218357 2137167  0.506  0.488\n\n# Proportion of Rep votes by district\nnc_results |&gt;\n  select(district, r_prop, winner) |&gt;\n  arrange(desc(r_prop))\n\n# A tibble: 13 × 3\n   district r_prop winner    \n      &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;     \n 1        3  0.631 Republican\n 2        6  0.609 Republican\n 3        5  0.575 Republican\n 4       11  0.574 Republican\n 5       10  0.570 Republican\n 6       13  0.568 Republican\n 7        2  0.559 Republican\n 8        8  0.532 Republican\n 9        9  0.518 Republican\n10        7  0.499 Democrat  \n11        4  0.255 Democrat  \n12        1  0.229 Democrat  \n13       12  0.204 Democrat  \n\n\nNow let’s layer the results above on a map of North Carolina to create an effective visualization of the situation. How does the shape of districts where Republicans won compare with the shape where Democrats won?\n\n# Download congressional district shapefiles for the 113th Congress from a UCLA website (don't sweat the details too much)\nsrc &lt;- \"http://cdmaps.polisci.ucla.edu/shp/districts113.zip\"\nlcl_zip &lt;- fs::path(tempdir(), \"districts113.zip\")\ndownload.file(src, destfile = lcl_zip)\nlcl_districts &lt;- fs::path(tempdir(), \"districts113\")\nunzip(lcl_zip, exdir = lcl_districts)\ndsn_districts &lt;- fs::path(lcl_districts, \"districtShapes\")\n\n# You can also downloaded zip file and uploaded it into R, but this uses a ton of space!\n# dsn_districts &lt;- fs::path(\"Data/districtShapes\")\n\n# read shapefiles into R as an sf object\nst_layers(dsn_districts)\n\nDriver: ESRI Shapefile \nAvailable layers:\n    layer_name geometry_type features fields crs_name\n1 districts113       Polygon      436     15    NAD83\n\n# be able to read as a data frame as well\ndistricts &lt;- st_read(dsn_districts, layer = \"districts113\") |&gt;\n  mutate(DISTRICT = parse_number(as.character(DISTRICT)))\n\nReading layer `districts113' from data source \n  `C:\\Users\\roback\\AppData\\Local\\Temp\\Rtmp4eRVCH\\districts113\\districtShapes' \n  using driver `ESRI Shapefile'\nSimple feature collection with 436 features and 15 fields (with 1 geometry empty)\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: -179.1473 ymin: 18.91383 xmax: 179.7785 ymax: 71.35256\nGeodetic CRS:  NAD83\n\nhead(districts, width = Inf)\n\nSimple feature collection with 6 features and 15 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: -91.82307 ymin: 29.41135 xmax: -66.94983 ymax: 47.45969\nGeodetic CRS:  NAD83\n  STATENAME           ID DISTRICT STARTCONG ENDCONG DISTRICTSI COUNTY PAGE  LAW\n1 Louisiana 022113114006        6       113     114       &lt;NA&gt;   &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;\n2     Maine 023113114001        1       113     114       &lt;NA&gt;   &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;\n3     Maine 023113114002        2       113     114       &lt;NA&gt;   &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;\n4  Maryland 024113114001        1       113     114       &lt;NA&gt;   &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;\n5  Maryland 024113114002        2       113     114       &lt;NA&gt;   &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;\n6  Maryland 024113114003        3       113     114       &lt;NA&gt;   &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;\n  NOTE BESTDEC                  FINALNOTE RNOTE                 LASTCHANGE\n1 &lt;NA&gt;    &lt;NA&gt; {\"From US Census website\"}  &lt;NA&gt; 2016-05-29 16:44:10.857626\n2 &lt;NA&gt;    &lt;NA&gt; {\"From US Census website\"}  &lt;NA&gt; 2016-05-29 16:44:10.857626\n3 &lt;NA&gt;    &lt;NA&gt; {\"From US Census website\"}  &lt;NA&gt; 2016-05-29 16:44:10.857626\n4 &lt;NA&gt;    &lt;NA&gt; {\"From US Census website\"}  &lt;NA&gt; 2016-05-29 16:44:10.857626\n5 &lt;NA&gt;    &lt;NA&gt; {\"From US Census website\"}  &lt;NA&gt; 2016-05-29 16:44:10.857626\n6 &lt;NA&gt;    &lt;NA&gt; {\"From US Census website\"}  &lt;NA&gt; 2016-05-29 16:44:10.857626\n  FROMCOUNTY                       geometry\n1          F MULTIPOLYGON (((-91.82288 3...\n2          F MULTIPOLYGON (((-70.98905 4...\n3          F MULTIPOLYGON (((-71.08216 4...\n4          F MULTIPOLYGON (((-77.31156 3...\n5          F MULTIPOLYGON (((-76.8763 39...\n6          F MULTIPOLYGON (((-77.15622 3...\n\nclass(districts)\n\n[1] \"sf\"         \"data.frame\"\n\n# create basic plot with NC congressional districts\nnc_shp &lt;- districts |&gt;\n  filter(STATENAME == \"North Carolina\")\nnc_shp |&gt;\n  st_geometry() |&gt;\n  plot(col = gray.colors(nrow(nc_shp)))\n\n\n\n# Append election results to geospatial data\nnc_merged &lt;- nc_shp |&gt;\n  st_transform(4326) |&gt;\n  inner_join(nc_results, by = c(\"DISTRICT\" = \"district\"))\nhead(nc_merged, width = Inf)\n\nSimple feature collection with 6 features and 23 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: -81.91811 ymin: 34.19118 xmax: -75.45998 ymax: 36.58812\nGeodetic CRS:  WGS 84\n       STATENAME           ID DISTRICT STARTCONG ENDCONG DISTRICTSI COUNTY PAGE\n1 North Carolina 037113114002        2       113     114       &lt;NA&gt;   &lt;NA&gt; &lt;NA&gt;\n2 North Carolina 037113114003        3       113     114       &lt;NA&gt;   &lt;NA&gt; &lt;NA&gt;\n3 North Carolina 037113114004        4       113     114       &lt;NA&gt;   &lt;NA&gt; &lt;NA&gt;\n4 North Carolina 037113114001        1       113     114       &lt;NA&gt;   &lt;NA&gt; &lt;NA&gt;\n5 North Carolina 037113114005        5       113     114       &lt;NA&gt;   &lt;NA&gt; &lt;NA&gt;\n6 North Carolina 037113114006        6       113     114       &lt;NA&gt;   &lt;NA&gt; &lt;NA&gt;\n   LAW NOTE BESTDEC                  FINALNOTE RNOTE                 LASTCHANGE\n1 &lt;NA&gt; &lt;NA&gt;    &lt;NA&gt; {\"From US Census website\"}  &lt;NA&gt; 2016-05-29 16:44:10.857626\n2 &lt;NA&gt; &lt;NA&gt;    &lt;NA&gt; {\"From US Census website\"}  &lt;NA&gt; 2016-05-29 16:44:10.857626\n3 &lt;NA&gt; &lt;NA&gt;    &lt;NA&gt; {\"From US Census website\"}  &lt;NA&gt; 2016-05-29 16:44:10.857626\n4 &lt;NA&gt; &lt;NA&gt;    &lt;NA&gt; {\"From US Census website\"}  &lt;NA&gt; 2016-05-29 16:44:10.857626\n5 &lt;NA&gt; &lt;NA&gt;    &lt;NA&gt; {\"From US Census website\"}  &lt;NA&gt; 2016-05-29 16:44:10.857626\n6 &lt;NA&gt; &lt;NA&gt;    &lt;NA&gt; {\"From US Census website\"}  &lt;NA&gt; 2016-05-29 16:44:10.857626\n  FROMCOUNTY state N total_votes d_votes r_votes other_votes    r_prop\n1          F    NC 8      311397  128973  174066        8358 0.5589842\n2          F    NC 3      309885  114314  195571           0 0.6311083\n3          F    NC 4      348485  259534   88951           0 0.2552506\n4          F    NC 4      338066  254644   77288        6134 0.2286181\n5          F    NC 3      349197  148252  200945           0 0.5754488\n6          F    NC 4      364583  142467  222116           0 0.6092330\n      winner                       geometry\n1 Republican MULTIPOLYGON (((-80.05325 3...\n2 Republican MULTIPOLYGON (((-78.27217 3...\n3   Democrat MULTIPOLYGON (((-79.47249 3...\n4   Democrat MULTIPOLYGON (((-78.95837 3...\n5 Republican MULTIPOLYGON (((-81.91805 3...\n6 Republican MULTIPOLYGON (((-80.97462 3...\n\n# Color based on winning party\n#   Note that geom_sf is part of ggplot2 package, while st_geometry is\n#   part of sf package\nnc &lt;- ggplot(data = nc_merged, aes(fill = winner)) +\n  annotation_map_tile(zoom = 6, type = \"osm\", progress = \"none\") + \n  geom_sf(alpha = 0.5) +\n  scale_fill_manual(\"Winner\", values = c(\"blue\", \"red\")) + \n  geom_sf_label(aes(label = DISTRICT), fill = \"white\") + \n  theme_void()\nnc\n\n\n\n# Color based on proportion Rep.  Be sure to let limits so centered at 0.5.\n# This is a choropleth map, where meaningful shading relates to some attribute\nnc +\n  aes(fill = r_prop) + \n  scale_fill_distiller(\n    \"Proportion\\nRepublican\", \n    palette = \"RdBu\", \n    limits = c(0.2, 0.8)\n  )\n\n\n\n# A leaflet map can allow us to zoom in and see where major cities fit, etc.\nlibrary(leaflet)\npal &lt;- colorNumeric(palette = \"RdBu\", domain = c(0, 1))\n\nleaflet_nc &lt;- leaflet(nc_merged) |&gt;\n  addTiles() |&gt;\n  addPolygons(\n    weight = 1, fillOpacity = 0.7, \n    color = ~pal(1 - r_prop),   # so red association with Reps\n    popup = ~paste(\"District\", DISTRICT, \"&lt;/br&gt;\", round(r_prop, 4))\n  ) |&gt;                          # popups show prop Republican\n  setView(lng = -80, lat = 35, zoom = 7)\nleaflet_nc\n\n\n\n\n\n[Pause to ponder:] What have you learned by layering the voting data on the voting districts of North Carolina?"
  }
]